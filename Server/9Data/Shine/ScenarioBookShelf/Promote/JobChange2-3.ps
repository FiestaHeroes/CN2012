open [main]
    var PlayerHandle        ""

        ElderinHandle       ""      ; NPC들 핸들
        RoumenHandle        ""

        WaitMinute          0

        Temp                ""
        LoginWait           ""
        InterruptBlock      ""
        InterruptArg        "".


    mobregen ElderinHandle "Job2_YongE"   9081 9727 181 1000 "Normal".
    mobregen RoumenHandle  "Job2_BraveR"  9224 9548 155 1000 "Normal".


    scriptfile "JobChange2-3".

    waitlogin LoginWait.                                                    ; 플레이어의 로긴 기다림
    if LoginWait == 0
    then open
        call "QuestFail".
    close

    findhandle PlayerHandle "Player" 0.                                     ; 플레이어의 핸들을 찾음(처음 하나만)


    timelimit Min 5.


    ;;;;;;;;;;
    ;; 만남 ;;
    ;;;;;;;;;;
    interruptclear all.
    interruptset AreaEntry "" 1 "Job2_Zone02" "FirstContect".
    interruptset TimeOut "" 1 "QuestFail".

    broadcast all "MissionObj".

    open [BeforeContect]
        infinite
        open
            waitinterrupt InterruptBlock "InterruptArg".
            call InterruptBlock.
        close
    close


    chatwin "Job2_BraveR" "FirstR0".
    pause Sec 2.
    chatwin "Job2_BraveR" "FirstR1".
    pause Sec 2.
    chatwin "Job2_YongE"  "FirstE2".
    pause Sec 2.
    chatwin "Job2_BraveR" "FirstR3".
    pause Sec 2.
    chatwin "Job2_YongE"  "FirstE4".
    pause Sec 2.
    chatwin "Job2_YongE"  "FirstE5".
    pause Sec 2.
    chatwin "Job2_BraveR" "FirstR6".
    pause Sec 2.
    chatwin "Job2_BraveR" "FirstR7".


    timelimit Min 20.

    interruptclear all.

    interruptset TimeOut "" 1 "QuestSuc".
    interruptset PlayerEliminate "" 1 "QuestFail".
    interruptset DeadHandle "" 1 ElderinHandle "QuestFail".
    interruptset DeadHandle "" 1 RoumenHandle "QuestFail".


    regengroup "Job2_Dn02" "Dn02_Mob1-1".
    regengroup "Job2_Dn02" "Dn02_Mob1-2".

    WaitMinute = 1.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_BraveR" "SecondR0".
    pause Sec 2.
    chatwin "Job2_YongE"  "SecondE1".
    pause Sec 2.
    chatwin "Job2_YongE"  "SecondE2".

    regengroup "Job2_Dn02" "Dn02_Mob2-1".
    regengroup "Job2_Dn02" "Dn02_Mob2-2".

    WaitMinute = 1.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_BraveR" "ThirdR0".
    pause Sec 2.
    chatwin "Job2_YongE"  "ThirdE1".
    pause Sec 2.
    chatwin "Job2_BraveR" "ThirdR2".

    regengroup "Job2_Dn02" "Dn02_Mob3-1".
    regengroup "Job2_Dn02" "Dn02_Mob3-2".

    WaitMinute =1.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_BraveR" "ForthR0".
    pause Sec 2.
    chatwin "Job2_YongE"  "ForthE1".
    pause Sec 2.
    chatwin "Job2_BraveR" "ForthR2".

    regengroup "Job2_Dn02" "Dn02_Mob4-1".
    regengroup "Job2_Dn02" "Dn02_Mob4-2".

    WaitMinute = 2.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_BraveR" "FifthR0".
    pause Sec 2.
    chatwin "Job2_BraveR" "FifthR1".
    pause Sec 2.
    chatwin "Job2_YongE"  "FifthE2".

    regengroup "Job2_Dn02" "Dn02_Mob5-1".
    regengroup "Job2_Dn02" "Dn02_Mob5-2".

    WaitMinute = 2.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_YongE"  "SixthE0".
    pause Sec 2.
    chatwin "Job2_BraveR" "SixthR1".
    pause Sec 2.
    chatwin "Job2_YongE"  "SixthE2".

    regengroup "Job2_Dn02" "Dn02_Mob6-1".
    regengroup "Job2_Dn02" "Dn02_Mob6-2".

    WaitMinute = 2.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_YongE"  "SeventhE0".
    pause Sec 2.
    chatwin "Job2_BraveR" "SeventhR1".
    pause Sec 2.
    chatwin "Job2_YongE"  "SeventhE2".

    regengroup "Job2_Dn02" "Dn02_Mob7-1".
    regengroup "Job2_Dn02" "Dn02_Mob7-2".

    WaitMinute = 3.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_BraveR" "EighthR0".
    pause Sec 2.
    chatwin "Job2_YongE"  "EighthE1".
    pause Sec 2.
    chatwin "Job2_BraveR" "EighthR2".

    regengroup "Job2_Dn02" "Dn02_Mob8-1".
    regengroup "Job2_Dn02" "Dn02_Mob8-2".

    WaitMinute = 3.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_YongE"  "NinethE0".
    pause Sec 2.
    chatwin "Job2_BraveR" "NinethR1".
    pause Sec 2.
    chatwin "Job2_YongE"  "NinethE2".

    regengroup "Job2_Dn02" "Dn02_Mob9-1".
    regengroup "Job2_Dn02" "Dn02_Mob9-2".

    WaitMinute = 3.
    call "WaitMinuteRoutine".

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

    chatwin "Job2_BraveR" "TenthR0".
    pause Sec 2.
    chatwin "Job2_YongE"  "TenthE1".
    pause Sec 2.
    chatwin "Job2_BraveR" "TenthR2".

    regengroup "Job2_Dn02" "Dn02_Mob10-1".
    regengroup "Job2_Dn02" "Dn02_Mob10-2".

    ;WaitMinute = 2.
    ;call "WaitMinuteRoutine".



    ;; 유저가 NPC와 함께 모든 몹을 잡을 때까지 대기 ;;
    open [Cooperation2]
        infinite
        open
            waitinterrupt InterruptBlock "InterruptArg".
            call InterruptBlock.
        close
    close
close

open [QuestSuc]
    questresult Suc.
    itemcreate PlayerHandle "Job2_RouNec".

    chatwin "Job2_BraveR" "SucR0".
    pause Sec 2.
    chatwin "Job2_YongE"  "SucE1".
    pause Sec 2.
    chatwin "Job2_BraveR" "SucR2".
    pause Sec 2.
    chatwin "Job2_YongE"  "SucE3".
    pause Sec 2.
    chatwin "Job2_BraveR" "SucR4".
    pause Sec 2.
    chatwin "Job2_BraveR" "SucR5".
    pause Sec 2.
    chatwin "Job2_BraveR" "SucR6".

    broadcast all "RouReturn30".
    pause sec 10.
    broadcast all "RouReturn20".
    pause sec 10.
    broadcast all "RouReturn10".
    pause sec 5.
    broadcast all "RouReturn5".
    pause sec 5.
    linkto all "RouN" "RouN" 6203 7547.
close

open [FirstContect]
    interrupterase "HeroClick".
    break "BeforeContect".
close

open [QuestFail]
    printf "QuestFail".

    questresult Fail.                  ; 실패패킷 날림

    broadcast all "RouReturn30".
    pause sec 10.
    broadcast all "RouReturn20".
    pause sec 10.
    broadcast all "RouReturn10".
    pause sec 5.
    broadcast all "RouReturn5".
    pause sec 5.
    linkto all "RouN" "RouN" 6203 7547.
    break "main".
close

open [WaitMinuteRoutine]
    interruptset Minute "" 1 WaitMinute "TimeEnd".

    infinite
    open
        waitinterrupt InterruptBlock "InterruptArg".
        call InterruptBlock.
    close
close

open [TimeEnd]
    break "WaitMinuteRoutine".
close
